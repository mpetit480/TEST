<?xml version="1.0" encoding="UTF-8"?>
<jobi>
   <metadata>
      <row>
         <version>21.0.0</version>
      </row>
   </metadata>
   <general_attributes>
      <row>
         <minimum_ae_version>11.2</minimum_ae_version>
         <child_flags>00000000000000000000000000000000</child_flags>
         <last_runtimes>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</last_runtimes>
         <name>JOBI.ASO.SHAREPOINT.PEP_SHAREPOINT</name>
         <type>JOBI</type>
         <versioning_id>614665702</versioning_id>
      </row>
   </general_attributes>
   <scripts>
      <row>
         <process><![CDATA[! set date formats
:SET &STD_DATE# = SYS_LDATE('DD.MM.YYYY')
:PUBLISH &STD_DATE#, , "WORKFLOW"
:SET &STD_DATE# = SYS_LDATE('YYYYMMDD')
:PUBLISH &STD_DATE#, , "WORKFLOW"
:SET &SYS_DATE_MINUS# = SYS_LDATE('YYYY-MM-DD')
:PUBLISH &SYS_DATE_MINUS#, , "WORKFLOW"
!
! VARA objects used
:SET &VARA_NAME_TICKET# = STR_CAT(VARA.ASO.SHAREPOINT_PEP@FROM_TICKET_, &REQUEST_NUMBER#)
! doit etre changi par &VARA_NAME_TICKET# directement
:PUBLISH &VARA_NAME_TICKET#, , "WORKFLOW"
:SET &VARA_NAME_STATIC# = "VARA.ASO.SHAREPOINT_CREATE@STATIC"
:PUBLISH &VARA_NAME_STATIC#, , "WORKFLOW"
!
! set variable from VARA_NAME_TICKET
:SET &COMPTE_ADMIN# = GET_VAR(&VARA_NAME_TICKET#, "COMPTE_ADMIN#")
:PUBLISH &COMPTE_ADMIN#, , "WORKFLOW"
:SET &DNS_SITE# = GET_VAR(&VARA_NAME_TICKET#, "DNS_SITE#")
:PUBLISH &DNS_SITE#, , "WORKFLOW"
:SET &ENVIRONNEMENT# = GET_VAR(&VARA_NAME_TICKET#, "ENVIRONNEMENT#")
:PUBLISH &ENVIRONNEMENT#, , "WORKFLOW"
:SET &TITRE_SHAREPOINT# = GET_VAR(&VARA_NAME_TICKET#, "TITRE_SHAREPOINT#")
:PUBLISH &TITRE_SHAREPOINT#, , "WORKFLOW"
:SET &REQUEST_NUMBER# = GET_VAR(&VARA_NAME_TICKET#, "REQUEST_NUMBER#")
:PUBLISH &REQUEST_NUMBER#, , "WORKFLOW"
:SET &Volumetrie# = GET_VAR(&VARA_NAME_TICKET#, "Volumetrie#")
:PUBLISH &Volumetrie#, , "WORKFLOW"
:SET &Benef_BU# = GET_VAR(&VARA_NAME_TICKET#, "Benef_BU#")
:PUBLISH &Benef_BU#, , "WORKFLOW"
!
!
!  Agents
:SET &HOST_NETSCALER# = GET_VAR(&VARA_NAME_STATIC#, "HOST_NETSCALER#")
:PUBLISH &HOST_NETSCALER#, , "WORKFLOW"
:SET &HOST_DNS# = GET_VAR(&VARA_NAME_STATIC#, "HOST_DNS#")
:PUBLISH &HOST_DNS#, , "WORKFLOW"
:SET &HOST_HEAT# = GET_VAR(&VARA_NAME_STATIC#, "HOST_HEAT#")
:PUBLISH &HOST_HEAT#, , "WORKFLOW"
:SET &HOST_HEAT_SQL# = GET_VAR(&VARA_NAME_STATIC#, "HOST_HEAT_SQL#")
:PUBLISH &HOST_HEAT_SQL#, , "WORKFLOW"
:SET &HOST_SHAREPOINT_1# = GET_VAR(&VARA_NAME_STATIC#, "HOST_SHAREPOINT_1_&ENVIRONNEMENT##")
:PUBLISH &HOST_SHAREPOINT_1#, , "WORKFLOW"
:SET &HOST_SHAREPOINT_2# = GET_VAR(&VARA_NAME_STATIC#, "HOST_SHAREPOINT_2_&ENVIRONNEMENT##")
:PUBLISH &HOST_SHAREPOINT_2#, , "WORKFLOW"
:SET &HOST_SHAREPOINT_PRIMARY# = GET_VAR(&VARA_NAME_STATIC#, "HOST_SHAREPOINT_PRIMARY_&ENVIRONNEMENT##")
:PUBLISH &HOST_SHAREPOINT_PRIMARY#, , "WORKFLOW"
!

!
! set variable from VARA_NAME_STATIC
! ENTREPRISE ENDEL OU INEO
:IF &Benef_BU# = "ENDEL"
:  SET &DNS_DATA# = GET_VAR(&VARA_NAME_STATIC#, "DNS_DATA_&ENVIRONNEMENT##", 2)
:  PUBLISH &DNS_DATA#, , "WORKFLOW"
:  SET &DNS_DCP_ZONE# = GET_VAR(&VARA_NAME_STATIC#, "DNS_DCP_ZONE#", 2)
:  PUBLISH &DNS_DCP_ZONE#, , "WORKFLOW"
:  SET &DNS_DMZ_ZONE# = GET_VAR(&VARA_NAME_STATIC#, "DNS_DMZ_ZONE#", 2)
:  PUBLISH &DNS_DMZ_ZONE#, , "WORKFLOW"
:  SET &NETSCALER_CSVS_DCP# = GET_VAR(&VARA_NAME_STATIC#, "NETSCALER_CSVS_DCP#", 2)
:  PUBLISH &NETSCALER_CSVS_DCP#, , "WORKFLOW"
:  IF &URL_EXT# = "true"
:    SET &IIS_WEBAPP_SITENAME# = GET_VAR(&VARA_NAME_STATIC#, "IIS_WEBAPP_SITENAME_EXT_&ENVIRONNEMENT##", 2)
:  ELSE
:    SET &IIS_WEBAPP_SITENAME# = GET_VAR(&VARA_NAME_STATIC#, "IIS_WEBAPP_SITENAME_INT_&ENVIRONNEMENT##", 2)
:  ENDIF
:  PUBLISH &IIS_WEBAPP_SITENAME#, , "WORKFLOW"

:ELSE
:  SET &DNS_DATA# = GET_VAR(&VARA_NAME_STATIC#, "DNS_DATA_&ENVIRONNEMENT##")
:  PUBLISH &DNS_DATA#, , "WORKFLOW"
:  SET &DNS_DCP_ZONE# = GET_VAR(&VARA_NAME_STATIC#, "DNS_DCP_ZONE#")
:  PUBLISH &DNS_DCP_ZONE#, , "WORKFLOW"
:  SET &DNS_DMZ_ZONE# = GET_VAR(&VARA_NAME_STATIC#, "DNS_DMZ_ZONE#")
:  PUBLISH &DNS_DMZ_ZONE#, , "WORKFLOW"
:  SET &NETSCALER_CSVS_DCP# = GET_VAR(&VARA_NAME_STATIC#, "NETSCALER_CSVS_DCP#")
:  PUBLISH &NETSCALER_CSVS_DCP#, , "WORKFLOW"
:  IF &URL_EXT# = "true"
:    SET &IIS_WEBAPP_SITENAME# = GET_VAR(&VARA_NAME_STATIC#, "IIS_WEBAPP_SITENAME_EXT_&ENVIRONNEMENT##")
:  ELSE
:    SET &IIS_WEBAPP_SITENAME# = GET_VAR(&VARA_NAME_STATIC#, "IIS_WEBAPP_SITENAME_INT_&ENVIRONNEMENT##")
:  ENDIF
:  PUBLISH &IIS_WEBAPP_SITENAME#, , "WORKFLOW"
:ENDIF


:SET &TARGET_NETSCALER# = GET_VAR(&VARA_NAME_STATIC#, "TARGET_NETSCALER_&ENVIRONNEMENT##")
:PUBLISH &TARGET_NETSCALER#, , "WORKFLOW"


:SET &NETSCALER_PASSWORD# = GET_VAR(&VARA_NAME_STATIC#, "NETSCALER_PASSWORD#")
:PUBLISH &NETSCALER_PASSWORD#, , "WORKFLOW"
:SET &NETSCALER_POLICY_NAME_DCP# = GET_VAR(&VARA_NAME_STATIC#, "NETSCALER_POLICY_NAME_DCP_&ENVIRONNEMENT##")
:PUBLISH &NETSCALER_POLICY_NAME_DCP#, , "WORKFLOW"
:SET &NETSCALER_POLICY_NAME_DMZ# = GET_VAR(&VARA_NAME_STATIC#, "NETSCALER_POLICY_NAME_DMZ_&ENVIRONNEMENT##")
:PUBLISH &NETSCALER_POLICY_NAME_DMZ#, , "WORKFLOW"
:SET &NETSCALER_USERNAME# = GET_VAR(&VARA_NAME_STATIC#, "NETSCALER_USERNAME#")
:PUBLISH &NETSCALER_USERNAME#, , "WORKFLOW"

:SET &NETSCALER_CSVS_DMZ# = GET_VAR(&VARA_NAME_STATIC#, "NETSCALER_CSVS_DMZ#")
:PUBLISH &NETSCALER_CSVS_DMZ#, , "WORKFLOW"
:SET &NETSCALER_LBVS_DCP# = GET_VAR(&VARA_NAME_STATIC#, "NETSCALER_LBVS_DCP_&ENVIRONNEMENT##")
:PUBLISH &NETSCALER_LBVS_DCP#, , "WORKFLOW"
:SET &NETSCALER_LBVS_DMZ# = GET_VAR(&VARA_NAME_STATIC#, "NETSCALER_LBVS_DMZ_&ENVIRONNEMENT##")
:PUBLISH &NETSCALER_LBVS_DMZ#, , "WORKFLOW"
:SET &HEAT_NAME_ACTION# = GET_VAR(&VARA_NAME_STATIC#, "HEAT_NAME_ACTION#")
:PUBLISH &HEAT_NAME_ACTION#, , "WORKFLOW"
:SET &HEAT_NAME_DEMANDE# = GET_VAR(&VARA_NAME_STATIC#, "HEAT_NAME_DEMANDE#")
:PUBLISH &HEAT_NAME_DEMANDE#, , "WORKFLOW"


:SET &SHAREPOINT_ADMIN# = GET_VAR(&VARA_NAME_STATIC#, "SHAREPOINT_ADMIN#")
:PUBLISH &SHAREPOINT_ADMIN#, , "WORKFLOW"

:SET &ADM1_GID# = GET_VAR(&VARA_NAME_TICKET#, "ADM1_GID#")
:PUBLISH &ADM1_GID#, , "WORKFLOW"

:SET &URL_EXT# = GET_VAR(&VARA_NAME_TICKET#, "URL_EXT#")
:PUBLISH &URL_EXT#, , "WORKFLOW"
]]></process>
      </row>
   </scripts>
</jobi>
